<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistir Junto Privado PRO</title>

<style>
*{box-sizing:border-box;}
body{
margin:0;
font-family:Arial, Helvetica, sans-serif;
background:#0f0f0f;
color:white;
display:flex;
justify-content:center;
}
.hidden{display:none;}
.card{
width:95%;
max-width:700px;
margin:40px auto;
background:#181818;
padding:25px;
border-radius:16px;
box-shadow:0 0 25px rgba(0,0,0,0.6);
}
h1{text-align:center;margin-bottom:10px;font-size:22px;}
.online{text-align:center;font-size:14px;margin-bottom:5px;color:#bbb;}
.global-online{text-align:center;font-size:13px;margin-bottom:15px;color:#00ff88;}
.creator{margin-top:20px;font-size:12px;color:#888;text-align:center;}
.creator a{color:#e50914;text-decoration:none;}
input{
width:100%;padding:14px;border:none;border-radius:10px;
background:#2a2a2a;color:white;font-size:14px;margin-bottom:12px;
}
.btn{
width:100%;padding:14px;background:#e50914;color:white;
border:none;border-radius:10px;font-size:14px;cursor:pointer;margin-bottom:15px;
}
.btn-secondary{background:#333;}
.video-box{
width:100%;background:#000;border-radius:12px;
overflow:hidden;position:relative;margin-bottom:20px;
}
.video-wrapper{position:relative;width:100%;padding-top:56.25%;}
.video-wrapper iframe,
.video-wrapper video{
position:absolute;top:0;left:0;width:100%;height:100%;
border:none;object-fit:contain;background:black;
}
.chat{
background:#111;border-radius:12px;padding:15px;
max-height:280px;display:flex;flex-direction:column;margin-bottom:15px;
}
#chatBox{flex:1;overflow-y:auto;margin-bottom:10px;}
.msg{
background:#222;padding:8px 12px;border-radius:8px;
margin-bottom:8px;font-size:13px;word-break:break-word;
}
.msg strong{color:#e50914;}
.btn-sair{
width:100%;padding:12px;background:#444;color:white;
border:none;border-radius:10px;font-size:14px;cursor:pointer;
}
.login,.home{
width:95%;max-width:500px;margin:100px auto;
background:#181818;padding:30px;border-radius:16px;text-align:center;
}
</style>
</head>
<body>

<div class="home" id="homeBox">
<h2>üé¨ Assistir Junto Privado PRO</h2>
<button class="btn" id="btnAbrirLogin">Entrar na Sala</button>
<div class="global-online" id="totalOnlineGlobal">Usu√°rios no site: 0</div>
</div>

<div class="login hidden" id="loginBox">
<h2>üîê Entrar na Sala</h2>
<input type="text" id="nomeUsuario" placeholder="Seu nome">
<input type="password" id="senhaSala" placeholder="Senha da sala">
<button class="btn" id="btnEntrar">Entrar</button>
<button class="btn btn-secondary" id="btnVoltar">Voltar</button>
</div>

<div class="card hidden" id="salaBox">
<h1>üé¨ Sala Privada</h1>
<div class="online" id="onlineInfo">Online na sala: 0</div>

<input type="text" id="linkInput" placeholder="Link YouTube ou .mp4">
<button class="btn" id="btnEnviarVideo">Enviar V√≠deo</button>

<input type="file" id="videoFile" accept="video/*" class="btn">

<div class="video-box">
<div class="video-wrapper" id="videoArea"></div>
</div>

<h3>Bate-Papo</h3>
<div class="chat">
<div id="chatBox"></div>
<input type="text" id="chatInput" placeholder="Mensagem">
<button class="btn" id="btnEnviarMsg">Enviar</button>
</div>

<button class="btn-sair" onclick="location.reload()">Sair da Sala</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc, onSnapshot, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
apiKey:"SUA_KEY",
authDomain:"SEU_AUTH",
projectId:"SEU_PROJECT"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* PEGANDO ELEMENTOS CORRETAMENTE */
const homeBox = document.getElementById("homeBox");
const loginBox = document.getElementById("loginBox");
const salaBox = document.getElementById("salaBox");
const btnAbrirLogin = document.getElementById("btnAbrirLogin");
const btnVoltar = document.getElementById("btnVoltar");
const btnEntrar = document.getElementById("btnEntrar");
const nomeUsuario = document.getElementById("nomeUsuario");
const senhaSala = document.getElementById("senhaSala");
const onlineInfo = document.getElementById("onlineInfo");
const btnEnviarMsg = document.getElementById("btnEnviarMsg");
const chatInput = document.getElementById("chatInput");
const chatBox = document.getElementById("chatBox");
const btnEnviarVideo = document.getElementById("btnEnviarVideo");
const linkInput = document.getElementById("linkInput");
const videoFile = document.getElementById("videoFile");
const videoArea = document.getElementById("videoArea");

let salaRef = null;
let nomeLocal = "";

/* BOT√ïES */
btnAbrirLogin.onclick = ()=>{
homeBox.classList.add("hidden");
loginBox.classList.remove("hidden");
};

btnVoltar.onclick = ()=>{
loginBox.classList.add("hidden");
homeBox.classList.remove("hidden");
};

btnEntrar.onclick = async ()=>{
let senha = senhaSala.value.trim();
let nome = nomeUsuario.value.trim();

if(!senha || !nome){
alert("Preencha tudo");
return;
}

nomeLocal = nome;
salaRef = doc(db,"salas",senha);

let snap = await getDoc(salaRef);
if(!snap.exists()){
await setDoc(salaRef,{video:"",chat:[],online:[]});
}

await updateDoc(salaRef,{online:arrayUnion(nomeLocal)});

loginBox.classList.add("hidden");
salaBox.classList.remove("hidden");

onSnapshot(salaRef,(docSnap)=>{
let dados = docSnap.data();
if(dados.video) carregarVideo(dados.video);
mostrarChat(dados.chat||[]);
onlineInfo.innerText="Online na sala: "+(dados.online?dados.online.length:0);
});
};

btnEnviarMsg.onclick = async ()=>{
let texto = chatInput.value.trim();
if(!texto) return;
await updateDoc(salaRef,{
chat:arrayUnion({nome:nomeLocal,msg:texto})
});
chatInput.value="";
};

function mostrarChat(lista){
chatBox.innerHTML="";
lista.forEach(item=>{
let div=document.createElement("div");
div.className="msg";
div.innerHTML="<strong>"+item.nome+":</strong> "+item.msg;
chatBox.appendChild(div);
});
chatBox.scrollTop=chatBox.scrollHeight;
}

btnEnviarVideo.onclick = async ()=>{
let link = linkInput.value.trim();
if(!link) return;
await updateDoc(salaRef,{video:link});
linkInput.value="";
};

videoFile.onchange = async (e)=>{
const file=e.target.files[0];
if(!file) return;
const reader=new FileReader();
reader.onload=async function(event){
await updateDoc(salaRef,{video:event.target.result});
};
reader.readAsDataURL(file);
};

function carregarVideo(link){
videoArea.innerHTML="";
if(link.startsWith("data:video")){
let video=document.createElement("video");
video.src=link;
video.controls=true;
video.autoplay=true;
videoArea.appendChild(video);
return;
}
if(link.includes("youtu")){
let id=link.includes("watch?v=")?
link.split("watch?v=")[1].split("&")[0]:
link.split("youtu.be/")[1].split("?")[0];
let iframe=document.createElement("iframe");
iframe.src="https://www.youtube.com/embed/"+id;
iframe.allowFullscreen=true;
videoArea.appendChild(iframe);
}else{
let video=document.createElement("video");
video.src=link;
video.controls=true;
video.autoplay=true;
videoArea.appendChild(video);
}
}
</script>
</body>
</html>
