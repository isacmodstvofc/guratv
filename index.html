<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistir Junto Privado PRO</title>

<style>
*{box-sizing:border-box;}
body{
margin:0;
font-family:Arial, Helvetica, sans-serif;
background:#0f0f0f;
color:white;
display:flex;
justify-content:center;
}
.hidden{display:none;}
.card{
width:95%;
max-width:700px;
margin:40px auto;
background:#181818;
padding:25px;
border-radius:16px;
box-shadow:0 0 25px rgba(0,0,0,0.6);
}
h1{text-align:center;margin-bottom:10px;font-size:22px;}
.online{text-align:center;font-size:14px;margin-bottom:5px;color:#bbb;}
.global-online{text-align:center;font-size:13px;margin-bottom:15px;color:#00ff88;}
.creator{margin-top:20px;font-size:12px;color:#888;text-align:center;}
.creator a{color:#e50914;text-decoration:none;}
input{
width:100%;
padding:14px;
border:none;
border-radius:10px;
background:#2a2a2a;
color:white;
font-size:14px;
margin-bottom:12px;
}
.btn{
width:100%;
padding:14px;
background:#e50914;
color:white;
border:none;
border-radius:10px;
font-size:14px;
cursor:pointer;
margin-bottom:15px;
}
.btn-secondary{background:#333;}
.video-box{
width:100%;
background:#d9d9d9;
border-radius:12px;
overflow:hidden;
position:relative;
margin-bottom:20px;
}
.video-wrapper{
position:relative;
width:100%;
padding-top:56.25%;
}
.video-wrapper iframe,
.video-wrapper video{
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
border:none;
object-fit:cover;
}
.chat{
background:#111;
border-radius:12px;
padding:15px;
max-height:280px;
display:flex;
flex-direction:column;
margin-bottom:15px;
}
#chatBox{flex:1;overflow-y:auto;margin-bottom:10px;}
.msg{
background:#222;
padding:8px 12px;
border-radius:8px;
margin-bottom:8px;
font-size:13px;
word-break:break-word;
}
.msg strong{color:#e50914;}
.btn-sair{
width:100%;
padding:12px;
background:#444;
color:white;
border:none;
border-radius:10px;
font-size:14px;
cursor:pointer;
}
.login, .home{
width:95%;
max-width:500px;
margin:100px auto;
background:#181818;
padding:30px;
border-radius:16px;
text-align:center;
}
.home p{
font-size:14px;
color:#ccc;
margin-bottom:15px;
line-height:1.6;
}
</style>
</head>
<body>

<!-- TODO SEU HTML CONTINUA IGUAL (não mexi em nada acima) -->

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc, onSnapshot, updateDoc, arrayUnion, increment } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
apiKey:"SUA_API",
authDomain:"SUA_AUTH",
projectId:"SUA_PROJECT"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

let salaRef=null;
let nomeLocal="";

/* ===== GALERIA CORRIGIDA ===== */

videoFile.onchange=async(e)=>{
const file=e.target.files[0];
if(!file)return;

/* LIMITADOR 20MB */
if(file.size > 20 * 1024 * 1024){
alert("Vídeo muito grande! Máximo 20MB");
return;
}

const reader=new FileReader();

reader.onload=async function(event){
const base64=event.target.result;

/* salva base64 no firestore */
await updateDoc(salaRef,{video:base64});
};

reader.readAsDataURL(file);
};

function carregarVideo(link){
videoArea.innerHTML="";

if(link.startsWith("data:video")){
let video=document.createElement("video");
video.src=link;
video.controls=true;
video.autoplay=true;
videoArea.appendChild(video);
return;
}

if(link.includes("youtu")){
let id="";
if(link.includes("watch?v=")){
id=link.split("watch?v=")[1].split("&")[0];
}else{
id=link.split("youtu.be/")[1].split("?")[0];
}
let iframe=document.createElement("iframe");
iframe.src="https://www.youtube.com/embed/"+id;
iframe.allowFullscreen=true;
videoArea.appendChild(iframe);
}else{
let video=document.createElement("video");
video.src=link;
video.controls=true;
video.autoplay=true;
videoArea.appendChild(video);
}
}

</script>
</body>
</html>
